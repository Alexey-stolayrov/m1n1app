<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>üéÆ –ú–∏–Ω–∏-–ò–≥—Ä—ã</title>
<script src="https://telegram.org/js/telegram-web-app.js"></script>

<style>
* { margin: 0; padding: 0; box-sizing: border-box; }
body {
    font-family: Arial, sans-serif;
    background: linear-gradient(135deg, #667eea, #764ba2);
    min-height: 100vh;
    color: white;
}
.container { max-width: 400px; margin: 0 auto; padding: 20px; }
.header { text-align: center; margin-bottom: 30px; }

.game-card {
    background: rgba(255,255,255,0.1);
    border-radius: 15px;
    padding: 20px;
    margin: 15px 0;
}

.btn {
    display: block;
    width: 100%;
    padding: 15px;
    margin: 10px 0;
    border: none;
    border-radius: 10px;
    font-size: 18px;
    font-weight: bold;
}

.btn-primary { background: linear-gradient(135deg, #f093fb, #f5576c); color: white; }
.btn-success { background: linear-gradient(135deg, #4cd964, #5ac8fa); color: white; }
.btn-danger { background: linear-gradient(135deg, #ff5858, #f09819); color: white; }

.hidden { display: none; }

/* ===== –°–¢–ê–†–ê–Ø –ë–ê–®–ù–Ø (–ö–ê–ö –ë–´–õ–û) ===== */
.tower {
    width: 100px;
    height: 300px;
    background: #8B4513;
    margin: 0 auto;
    position: relative;
}

.floor {
    width: 100%;
    height: 20px;
    background: #D2691E;
    margin: 2px 0;
}

/* ===== MONETA & DICE (–ù–ï –¢–†–û–ù–£–¢–´) ===== */
#coin {
    width: 100px;
    height: 100px;
    background: gold;
    border-radius: 50%;
    margin: 20px auto;
}

#dice {
    width: 100px;
    height: 100px;
    background: white;
    color: black;
    border-radius: 15px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 40px;
    margin: 20px auto;
}
</style>
</head>

<body>
<div class="container">

<div class="header">
    <h1>üéÆ –ú–∏–Ω–∏-–ò–≥—Ä—ã</h1>
</div>

<div id="mainMenu">
    <div class="game-card">
        <h2>üèóÔ∏è –ü–æ—Å—Ç—Ä–æ–π–∫–∞ –±–∞—à–Ω–∏</h2>
        <button class="btn btn-primary" onclick="startGame('tower_build')">–ò–≥—Ä–∞—Ç—å</button>
    </div>

    <div class="game-card">
        <h2>ü™ô –ü–æ–¥–±—Ä–æ—Å—å –º–æ–Ω–µ—Ç—É</h2>
        <button class="btn btn-success" onclick="startGame('coin_flip')">–ò–≥—Ä–∞—Ç—å</button>
    </div>

    <div class="game-card">
        <h2>üé≤ –ë—Ä–æ—Å–æ–∫ –∫—É–±–∏–∫–∞</h2>
        <button class="btn btn-danger" onclick="startGame('dice_roll')">–ò–≥—Ä–∞—Ç—å</button>
    </div>
</div>

<!-- ===== –ë–ê–®–ù–Ø ===== -->
<div id="towerGame" class="hidden">
    <div class="game-card">
        <h2>üèóÔ∏è –°—Ç—Ä–æ–π—Ç–µ –±–∞—à–Ω—é</h2>
        <p>–ù–∞–∂–º–∏—Ç–µ –∏ —É–¥–µ—Ä–∂–∏–≤–∞–π—Ç–µ</p>

        <div class="tower" id="tower"></div>
        <p>–í—ã—Å–æ—Ç–∞: <span id="height">0</span> —ç—Ç–∞–∂–µ–π</p>

        <button class="btn btn-primary"
            onmousedown="startBuilding()"
            ontouchstart="startBuilding()"
            onmouseup="stopBuilding()"
            ontouchend="stopBuilding()">‚¨áÔ∏è –°–¢–†–û–ò–¢–¨</button>

        <button class="btn btn-danger" onclick="backToMenu()">–ù–∞–∑–∞–¥</button>
    </div>
</div>

<!-- ===== MONETA ===== -->
<div id="coinGame" class="hidden">
    <div class="game-card">
        <h2>ü™ô –û—Ä—ë–ª –∏–ª–∏ —Ä–µ—à–∫–∞?</h2>
        <div id="coin"></div>
        <button class="btn btn-success" onclick="flipCoin('heads')">–û–†–Å–õ</button>
        <button class="btn btn-danger" onclick="flipCoin('tails')">–†–ï–®–ö–ê</button>
        <button class="btn" onclick="backToMenu()">–ù–∞–∑–∞–¥</button>
    </div>
</div>

<!-- ===== DICE ===== -->
<div id="diceGame" class="hidden">
    <div class="game-card">
        <h2>üé≤ –£–≥–∞–¥–∞–π—Ç–µ —á–∏—Å–ª–æ</h2>
        <div id="dice">?</div>
        <button class="btn" onclick="guessDice(1)">1</button>
        <button class="btn" onclick="guessDice(2)">2</button>
        <button class="btn" onclick="guessDice(3)">3</button>
        <button class="btn" onclick="guessDice(4)">4</button>
        <button class="btn" onclick="guessDice(5)">5</button>
        <button class="btn" onclick="guessDice(6)">6</button>
        <button class="btn" onclick="backToMenu()">–ù–∞–∑–∞–¥</button>
    </div>
</div>

</div>

<script>
const tg = window.Telegram.WebApp;
tg.expand();

let currentGame = '';
    let towerHeight = 0;
let buildingInterval;

/* ===== NAV ===== */
function startGame(game) {
    currentGame = game;
    mainMenu.classList.add('hidden');
    if (game === 'tower_build') {
        towerGame.classList.remove('hidden');
        initTower();
    }
    if (game === 'coin_flip') coinGame.classList.remove('hidden');
    if (game === 'dice_roll') diceGame.classList.remove('hidden');
}

function backToMenu() {
    towerGame.classList.add('hidden');
    coinGame.classList.add('hidden');
    diceGame.classList.add('hidden');
    mainMenu.classList.remove('hidden');
}

/* ===== –ë–ê–®–ù–Ø (–°–¢–ê–†–ê–Ø –õ–û–ì–ò–ö–ê) ===== */
function initTower() {
    towerHeight = 0;
    height.textContent = '0';
    tower.innerHTML = '';
}

function startBuilding() {
    buildingInterval = setInterval(() => {
        towerHeight++;
        height.textContent = towerHeight;

        const floor = document.createElement('div');
        floor.className = 'floor';
        tower.prepend(floor);

        if (towerHeight > 100) {
            stopBuilding();
            finishGame(towerHeight);
        }
    }, 100);
}

function stopBuilding() {
    clearInterval(buildingInterval);
    setTimeout(() => {
        if (towerHeight > 0) {
            finishGame(towerHeight);
        }
    }, 1000);
}

/* ===== –û–¢–ü–†–ê–í–ö–ê –í –ë–û–¢ ===== */
function finishGame(score) {
    tg.sendData(JSON.stringify({
        game_type: currentGame,
        bet: currentGame === 'tower_build' ? 100 :
             currentGame === 'coin_flip' ? 50 : 75,
        score: score
    }));
}

function flipCoin(choice) {
    tg.sendData(JSON.stringify({
        game_type: 'coin_flip',
        bet: 50,
        choice: choice
    }));
}

function guessDice(num) {
    tg.sendData(JSON.stringify({
        game_type: 'dice_roll',
        bet: 75,
        guess: num
    }));
}
</script>

</body>
</html>
