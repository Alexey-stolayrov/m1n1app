<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>üéÆ Mini Games</title>
<script src="https://telegram.org/js/telegram-web-app.js"></script>

<style>
* { margin: 0; padding: 0; box-sizing: border-box; }

body {
    font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
    background: radial-gradient(circle at top, #1b1f3b, #0f1224);
    color: #fff;
    min-height: 100vh;
}

.container {
    max-width: 420px;
    margin: auto;
    padding: 20px;
}

.header {
    text-align: center;
    margin-bottom: 25px;
}

.header h1 {
    font-size: 28px;
    font-weight: 800;
    letter-spacing: 1px;
}

/* ===== CARD ===== */
.game-card {
    background: rgba(255,255,255,0.08);
    backdrop-filter: blur(14px);
    border-radius: 18px;
    padding: 22px;
    margin-bottom: 18px;
    box-shadow: 0 10px 25px rgba(0,0,0,0.35);
}

.game-card h2 {
    margin-bottom: 10px;
    font-size: 20px;
}

/* ===== BUTTONS ===== */
.btn {
    width: 100%;
    padding: 14px;
    margin-top: 12px;
    border-radius: 14px;
    border: none;
    font-size: 17px;
    font-weight: 700;
    color: white;
    cursor: pointer;
    transition: transform .15s, box-shadow .15s;
}

.btn:active {
    transform: scale(0.97);
}

.btn-primary {
    background: linear-gradient(135deg, #ff6fd8, #ff8c7f);
}

.btn-success {
    background: linear-gradient(135deg, #32d2aa, #3aa1ff);
}

.btn-danger {
    background: linear-gradient(135deg, #ff5858, #f09819);
}

.hidden { display: none; }

/* ===== –ë–ê–®–ù–Ø (–°–¢–ê–†–ê–Ø –õ–û–ì–ò–ö–ê) ===== */
.tower {
    width: 110px;
    height: 300px;
    background: linear-gradient(180deg, #8b4513, #5c3317);
    margin: 20px auto;
    border-radius: 12px;
    padding-top: 5px;
}

.floor {
    width: 100%;
    height: 18px;
    background: linear-gradient(135deg, #d99058, #b87333);
    margin: 3px 0;
    border-radius: 3px;
}

/* ===== COIN ===== */
.coin {
    width: 130px;
    height: 130px;
    border-radius: 50%;
    margin: 20px auto;
    background: radial-gradient(circle at top, gold, orange);
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 42px;
    font-weight: bold;
    color: #222;
    box-shadow: 0 0 25px rgba(255,200,0,0.6);
    transition: transform .8s;
}

.coin.flip {
    transform: rotateY(720deg);
}

/* ===== DICE ===== */
.dice {
    width: 110px;
    height: 110px;
    border-radius: 22px;
    background: white;
    color: black;
    font-size: 42px;
    font-weight: bold;
    display: flex;
    align-items: center;
    justify-content: center;
    margin: 20px auto;
    box-shadow: 0 10px 20px rgba(0,0,0,0.4);
    transition: transform .4s;
}

.dice.roll {
    transform: rotate(360deg) scale(1.1);
}
</style>
</head>

<body>
<div class="container">

<div class="header">
    <h1>üéÆ MINI GAMES</h1>
</div>

<!-- MENU -->
<div id="mainMenu">
    <div class="game-card">
        <h2>üèóÔ∏è –ü–æ—Å—Ç—Ä–æ–π–∫–∞ –±–∞—à–Ω–∏</h2>
        <button class="btn btn-primary" onclick="startGame('tower_build')">–ò–≥—Ä–∞—Ç—å</button>
    </div>

    <div class="game-card">
        <h2>ü™ô –ú–æ–Ω–µ—Ç–∫–∞</h2>
        <button class="btn btn-success" onclick="startGame('coin_flip')">–ò–≥—Ä–∞—Ç—å</button>
    </div>

    <div class="game-card">
        <h2>üé≤ –ö—É–±–∏–∫</h2>
        <button class="btn btn-danger" onclick="startGame('dice_roll')">–ò–≥—Ä–∞—Ç—å</button>
    </div>
</div>

<!-- –ë–ê–®–ù–Ø -->
<div id="towerGame" class="hidden">
    <div class="game-card">
        <h2>üèóÔ∏è –°—Ç—Ä–æ–π –±–∞—à–Ω—é</h2>
        <div class="tower" id="tower"></div>
        <p style="text-align:center;">–≠—Ç–∞–∂–∏: <span id="height">0</span></p>

        <button class="btn btn-primary"
            onmousedown="startBuilding()"
            ontouchstart="startBuilding()"
            onmouseup="stopBuilding()"
            ontouchend="stopBuilding()">‚¨áÔ∏è –°–¢–†–û–ò–¢–¨</button>

        <button class="btn btn-danger" onclick="backToMenu()">–ù–∞–∑–∞–¥</button>
    </div>
</div>

<!-- COIN -->
<div id="coinGame" class="hidden">
    <div class="game-card">
        <h2>ü™ô –û—Ä—ë–ª –∏–ª–∏ —Ä–µ—à–∫–∞</h2>
        <div id="coin" class="coin">ü™ô</div>
        <button class="btn btn-success" onclick="flipCoin('heads')">–û–†–Å–õ</button>
        <button class="btn btn-danger" onclick="flipCoin('tails')">–†–ï–®–ö–ê</button>
        <button class="btn" onclick="backToMenu()">–ù–∞–∑–∞–¥</button>
    </div>
</div>

<!-- DICE -->
<div id="diceGame" class="hidden">
    <div class="game-card">
        <h2>üé≤ –£–≥–∞–¥–∞–π —á–∏—Å–ª–æ</h2>
        <div id="dice" class="dice">?</div>
        <button class="btn" onclick="guessDice(1)">1</button>
        <button class="btn" onclick="guessDice(2)">2</button>
        <button class="btn" onclick="guessDice(3)">3</button>
        <button class="btn" onclick="guessDice(4)">4</button>
        <button class="btn" onclick="guessDice(5)">5</button>
        <button class="btn" onclick="guessDice(6)">6</button>
        <button class="btn" onclick="backToMenu()">–ù–∞–∑–∞–¥</button>
    </div>
</div>

</div>

<script>
const tg = window.Telegram.WebApp;
tg.expand();

let currentGame = '';
let towerHeight = 0;
let interval;

/* NAV */
function startGame(game) {
    currentGame = game;
    mainMenu.classList.add('hidden');
    if (game === 'tower_build') initTower(), towerGame.classList.remove('hidden');
    if (game === 'coin_flip') coinGame.classList.remove('hidden');
    if (game === 'dice_roll') diceGame.classList.remove('hidden');
}

function backToMenu() {
    towerGame.classList.add('hidden');
    coinGame.classList.add('hidden');
    diceGame.classList.add('hidden');
    mainMenu.classList.remove('hidden');
}

/* –ë–ê–®–ù–Ø ‚Äî –°–¢–ê–†–ê–Ø –õ–û–ì–ò–ö–ê */
function initTower() {
    towerHeight = 0;
    height.textContent = '0';
    tower.innerHTML = '';
}

function startBuilding() {
    interval = setInterval(() => {
        towerHeight++;
        height.textContent = towerHeight;

        const floor = document.createElement('div');
        floor.className = 'floor';
        tower.prepend(floor);

        if (towerHeight >= 100) stopBuilding();
    }, 100);
}

function stopBuilding() {
    clearInterval(interval);
    setTimeout(() => {
        if (towerHeight > 0) {
            tg.sendData(JSON.stringify({
                game_type: 'tower_build',
                bet: 100,
                score: towerHeight
            }));
        }
    }, 700);
}

/* COIN */
function flipCoin(choice) {
    coin.classList.add('flip');
    setTimeout(() => {
        coin.classList.remove('flip');
        tg.sendData(JSON.stringify({
            game_type: 'coin_flip',
            bet: 50,
            choice
        }));
    }, 800);
}

/* DICE */
function guessDice(num) {
    dice.classList.add('roll');
    setTimeout(() => {
        dice.textContent = num;
        dice.classList.remove('roll');
        tg.sendData(JSON.stringify({
            game_type: 'dice_roll',
            bet: 75,
            guess: num
        }));
    }, 500);
}
</script>
</body>
</html>
